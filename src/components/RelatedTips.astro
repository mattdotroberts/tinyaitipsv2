---
import type { Tip } from '../lib/data';
import { getRelatedTips, getCreator } from '../lib/data';

interface Props {
  tip: Tip;
  limit?: number;
}

const { tip, limit = 3 } = Astro.props;
const relatedTips = getRelatedTips(tip, limit);

const difficultyColors = {
  'quick-win': 'bg-green-100 text-green-800',
  'moderate': 'bg-yellow-100 text-yellow-800',
  'advanced': 'bg-red-100 text-red-800',
};
---

{relatedTips.length > 0 && (
  <aside class="border-t border-gray-200 pt-8">
    <h2 class="text-sm font-semibold text-gray-500 uppercase tracking-wide mb-4">
      Related Tips
    </h2>
    <div class="space-y-3">
      {relatedTips.map(related => {
        const creator = getCreator(related.creator_id);
        return (
          <a
            href={`/tips/${related.slug}`}
            class="block p-3 border border-gray-200 rounded-lg hover:border-gray-400 hover:shadow-sm transition-all group"
          >
            <h3 class="font-medium text-gray-900 group-hover:text-blue-600 transition-colors text-sm mb-1">
              {related.title}
            </h3>
            <div class="flex items-center gap-2 text-xs">
              <span class={`px-2 py-0.5 rounded-full ${difficultyColors[related.difficulty]}`}>
                {related.difficulty}
              </span>
              {creator && (
                <span class="text-gray-500">{creator.name}</span>
              )}
            </div>
          </a>
        );
      })}
    </div>
  </aside>
)}
